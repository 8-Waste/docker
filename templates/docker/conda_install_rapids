RUN echo "CUDA_MAJORMINOR_VERSION = ${CUDA_MAJORMINOR_VERSION}"

RUN source activate rapids \
    && env \
    && conda list \
    && conda install -y -n rapids --freeze-installed --override-channels \
      -c rapidsai \
      -c rapidsai-nightly \
      -c nvidia \
      -c ${XGBOOST_CONDA_LABEL} \
      -c conda-forge \
      cudatoolkit=${CUDA_MAJORMINOR_VERSION} \
      cudf=${RAPIDS_CONDA_VERSION_SPEC} \
      cuspatial=${RAPIDS_CONDA_VERSION_SPEC} \
      cuml=${RAPIDS_CONDA_VERSION_SPEC} \
      cugraph=${RAPIDS_CONDA_VERSION_SPEC} \
      dask-cuda=${RAPIDS_CONDA_VERSION_SPEC} \
      dask-xgboost=${DASK_XGBOOST_CONDA_VERSION_SPEC} \
      numba=${NUMBA_VERSION} \
      numpy=${NUMPY_VERSION} \
      xgboost=${XGBOOST_VERSION} \
   && conda clean -afy \
   && chmod -R ugo+w /opt/conda ${RAPIDS_DIR}
