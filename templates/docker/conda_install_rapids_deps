# Install deps for all pkgs and remove the pkgs that were installed due to
# cross library deps. Also do not clean/chmod at end to save time as the
# notebook conda install will do the needed cleanup
RUN source activate rapids \
    && env \
    && conda list \
    && conda install -y -n rapids --freeze-installed --override-channels --only-deps \
         -c rapidsai \
         -c rapidsai-nightly \
         -c nvidia \
         -c ${XGBOOST_CONDA_LABEL} \
         -c numba \
         -c conda-forge \
         cudatoolkit=${CUDA_MAJORMINOR_VERSION} \
         cudf=${RAPIDS_CONDA_VERSION_SPEC} \
         cuml=${RAPIDS_CONDA_VERSION_SPEC} \
         cugraph=${RAPIDS_CONDA_VERSION_SPEC} \
         dask-cuda=${RAPIDS_CONDA_VERSION_SPEC} \
         dask-xgboost=${DASK_XGBOOST_CONDA_VERSION_SPEC} \
         xgboost=${XGBOOST_VERSION} \
         custreamz=${RAPIDS_CONDA_VERSION_SPEC} \
    && conda remove --force \
         rmm librmm \
         nvstrings libnvstrings \
         cudf dask-cudf libcudf \
         cuml libcuml \
         cugraph libcugraph \
         cuspatial \
         xgboost py-xgboost libxgboost \
         custreamz
