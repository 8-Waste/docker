{# This partial clones the BlazingSQL repo and build and installs it into the rapids conda env. #}

{# Install build prerequisites #}
RUN gpuci_conda_retry install -y -n rapids \
        google-cloud-cpp \
        ninja \
        gtest \
        gmock \
        cppzmq \
        openjdk=8.0 \
        maven \
        thrift=0.13.0 \
        jpype1 \
        netifaces \
        pyhive

ENV CUDF_HOME=/rapids/cudf

{# Clone, build, install. Note: This uses the current default branch instead of main. #}
RUN mkdir -p ${BLAZING_DIR} \
    && cd ${BLAZING_DIR} \
    && git clone https://github.com/BlazingDB/blazingsql.git

RUN source activate rapids \
    && cd ${BLAZING_DIR}/blazingsql \
    && ./build.sh
